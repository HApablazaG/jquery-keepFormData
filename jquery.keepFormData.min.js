/*
 jQuery keepFormData plugin v0.0.1
 (c) 2014, Alexandr Borisov.
 https://github.com/aishek/jquery-keepFormData
*/
$.keepFormData={};(function(){var b={}.hasOwnProperty;$.keepFormData.Util={"extends":function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);d.prototype=c.prototype;a.prototype=new d;a.__super__=c.prototype;return a}}})();
(function(){function b(a,b,d){this.form=a;this.node=b;this.save_events=d||"change paste keyup blur";this.attach_save_value_handler();this.load_value();this.node.data("keepFormDataInstance",this)}b.prototype.get_key=function(a){this.key||(this.key=this.form.key(this.node.attr("name")));return this.key};b.prototype.clear_value=function(){localStorage.removeItem(this.get_key())};b.prototype.save_value=function(){localStorage.setItem(this.get_key(),this.get_value())};b.prototype.load_value=function(){var a=
localStorage.getItem(this.get_key());this.set_value(a)};b.prototype.get_value=function(){return this.node.val()};b.prototype.set_value=function(a){void 0===a||null===a?this.node.val(this.node.attr("value")||this.node.text()):this.node.val(a)};b.prototype.attach_save_value_handler=function(){var a=this;this.node.on(this.save_events,function(){a.save_value()})};$.keepFormData.Input=b})();
(function(){function b(a,c){b.__super__.constructor.call(this,a,c,"change keyup blur")}$.keepFormData.Util["extends"](b,$.keepFormData.Input);b.prototype.set_value=function(a){if(void 0===a||null===a)a=$("option[selected]",this.node),a=a.attr("value")||a.text();this.node.val(a)};$.keepFormData.Select=b})();
(function(){function b(a,c){b.__super__.constructor.call(this,a,c,"change keyup blur")}$.keepFormData.Util["extends"](b,$.keepFormData.Input);b.prototype.get_value=function(){return this.node.is(":checked")?"1":"0"};b.prototype.set_value=function(a){switch(a){case "1":this.node.prop("checked",!0);break;case "0":this.node.prop("checked",!1);break;default:this.node.prop("checked",this.node.is("[checked]"))}};$.keepFormData.CheckBox=b})();
(function(){function b(a,c){b.__super__.constructor.call(this,a,c,"change keyup blur")}$.keepFormData.Util["extends"](b,$.keepFormData.Input);b.prototype.get_value=function(){return this.node.is(":checked")?this.node.val():void 0};b.prototype.set_value=function(a){this.node.prop("checked",a===this.node.val())};$.keepFormData.Radio=b})();
(function(){function b(a,b){this.node=a;this.prefix=b;this.name=this.guess_name(this.node);this.inputs=this.create_inputs(this.node);this.should_attach_clear_handler()&&this.attach_clear_handler()}b.prototype.key=function(a){return this.prefix+"["+this.name+"]["+a+"]"};b.prototype.should_attach_clear_handler=function(){var a=this.node.data("keep-form-data-clear-on-submit").toString().toLowerCase();return 0<this.inputs.length&&("1"===a||"yes"===a||"on"===a||"true"===a)};b.prototype.guess_name=function(a){var b;
if((b=a.attr("id"))&&0<b.length)return b;this.warn("Cannot use jQuery keepFormData \u2013 need id attr for <form>")};b.prototype.warn=function(a){console&&console.warn&&console.warn(a)};b.prototype.attach_clear_handler=function(){var a=this;this.node.on("submit",function(){a.clear_saved_values()})};b.prototype.clear=function(){this.clear_saved_values();for(var a=this.inputs,b=0,d=a.length;b<d;b++)a[b].load_value()};b.prototype.clear_saved_values=function(){for(var a=this.inputs,b=0,d=a.length;b<d;b++)a[b].clear_value()};
b.prototype.create_inputs=function(a){var b=this;return $("input, textarea, select",a).map(function(){return b.input_factory($(this))})};b.prototype.input_factory=function(a){var b;if(this.available_to_keep(a))switch(a.attr("type")){case "checkbox":b=new $.keepFormData.CheckBox(this,a);break;case "radio":b=new $.keepFormData.Radio(this,a);break;default:b=a.is("select")?new $.keepFormData.Select(this,a):new $.keepFormData.Input(this,a)}return b};b.prototype.available_to_keep=function(a){a=a.attr("name");
return void 0!==a&&0<a.length};$.keepFormData.Form=b})();(function(b){b.keepFormData.defaults={storage_keys_prefix:"keepFormData",form_selector:"form.keepFormData"};var a=b.keepFormData.defaults;b.fn.keepFormData=function(c){var d=b.extend({},a,c);c=b(this);d=new b.keepFormData.Form(c,d.storage_keys_prefix);c.data("keepFormDataInstance",d);return c};a.form_selector&&b(document).ready(function(){b(a.form_selector).each(function(){b(this).keepFormData()})})})(jQuery);
